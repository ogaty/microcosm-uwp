using microcosm.Common;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace microcosm.Config
{
    [JsonObject("setting")]
    public class SettingJson
    {
        [JsonProperty("version")]
        public int version;

        [JsonProperty("dispname")]
        public string dispname;

        [JsonProperty("dispPlanetSun")]
        public string dispPlanetSun;

        [JsonProperty("dispPlanetMoon")]
        public string dispPlanetMoon;

        [JsonProperty("dispPlanetMercury")]
        public string dispPlanetMercury;

        [JsonProperty("dispPlanetVenus")]
        public string dispPlanetVenus;

        [JsonProperty("dispPlanetMars")]
        public string dispPlanetMars;

        [JsonProperty("dispPlanetJupiter")]
        public string dispPlanetJupiter;

        [JsonProperty("dispPlanetSaturn")]
        public string dispPlanetSaturn;

        [JsonProperty("dispPlanetUranus")]
        public string dispPlanetUranus;

        [JsonProperty("dispPlanetNeptune")]
        public string dispPlanetNeptune;

        [JsonProperty("dispPlanetPluto")]
        public string dispPlanetPluto;

        [JsonProperty("dispPlanetDh")]
        public string dispPlanetDh;

        [JsonProperty("dispPlanetAsc")]
        public string dispPlanetAsc;

        [JsonProperty("dispPlanetMc")]
        public string dispPlanetMc;

        [JsonProperty("dispPlanetChiron")]
        public string dispPlanetChiron;

        [JsonProperty("dispPlanetEarth")]
        public string dispPlanetEarth;

        [JsonProperty("dispPlanetLilith")]
        public string dispPlanetLilith;

        [JsonProperty("dispPlanetCeres")]
        public string dispPlanetCeres;

        [JsonProperty("dispPlanetPallas")]
        public string dispPlanetPallas;

        [JsonProperty("dispPlanetJuno")]
        public string dispPlanetJuno;

        [JsonProperty("dispPlanetVesta")]
        public string dispPlanetVesta;

        [JsonProperty("dispPlanetEris")]
        public string dispPlanetEris;

        [JsonProperty("dispPlanetSedna")]
        public string dispPlanetSedna;

        [JsonProperty("dispPlanetHaumea")]
        public string dispPlanetHaumea;

        [JsonProperty("dispPlanetMakemake")]
        public string dispPlanetMakemake;

        [JsonProperty("dispPlanetVt")]
        public string dispPlanetVt;

        [JsonProperty("dispPlanetPof")]
        public string dispPlanetPof;

        [JsonProperty("aspectSun")]
        public string aspectSun;

        [JsonProperty("aspectMoon")]
        public string aspectMoon;

        [JsonProperty("aspectMercury")]
        public string aspectMercury;

        [JsonProperty("aspectVenus")]
        public string aspectVenus;

        [JsonProperty("aspectMars")]
        public string aspectMars;

        [JsonProperty("aspectJupiter")]
        public string aspectJupiter;

        [JsonProperty("aspectSaturn")]
        public string aspectSaturn;

        [JsonProperty("aspectUranus")]
        public string aspectUranus;

        [JsonProperty("aspectNeptune")]
        public string aspectNeptune;

        [JsonProperty("aspectPluto")]
        public string aspectPluto;

        [JsonProperty("aspectDh")]
        public string aspectDh;

        [JsonProperty("aspectAsc")]
        public string aspectAsc;

        [JsonProperty("aspectMc")]
        public string aspectMc;

        [JsonProperty("aspectChiron")]
        public string aspectChiron;

        [JsonProperty("aspectEarth")]
        public string aspectEarth;

        [JsonProperty("aspectConjunction")]
        public string aspectConjunction;

        [JsonProperty("aspectOpposition")]
        public string aspectOpposition;

        [JsonProperty("aspectConjunction1")]
        public string aspectConjunction1;

        [JsonProperty("aspectTrine")]
        public string aspectTrine;

        [JsonProperty("aspectSquare")]
        public string aspectSquare;

        [JsonProperty("aspectSextile")]
        public string aspectSextile;

        [JsonProperty("aspectConjunction2")]
        public string aspectConjunction2;

        [JsonProperty("aspectConjunction3")]
        public string aspectConjunction3;

        [JsonProperty("aspectConjunction4")]
        public string aspectConjunction4;

        [JsonProperty("aspectConjunction5")]
        public string aspectConjunction5;

        [JsonProperty("aspectConjunction6")]
        public string aspectConjunction6;

        [JsonProperty("aspectConjunction7")]
        public string aspectConjunction7;

        [JsonProperty("aspectOpposition1")]
        public string aspectOpposition1;

        [JsonProperty("aspectOpposition2")]
        public string aspectOpposition2;

        [JsonProperty("aspectOpposition3")]
        public string aspectOpposition3;

        [JsonProperty("aspectOpposition4")]
        public string aspectOpposition4;

        [JsonProperty("aspectOpposition5")]
        public string aspectOpposition5;

        [JsonProperty("aspectOpposition6")]
        public string aspectOpposition6;

        [JsonProperty("aspectOpposition7")]
        public string aspectOpposition7;

        [JsonProperty("aspectTrine1")]
        public string aspectTrine1;

        [JsonProperty("aspectTrine2")]
        public string aspectTrine2;

        [JsonProperty("aspectTrine3")]
        public string aspectTrine3;

        [JsonProperty("aspectTrine4")]
        public string aspectTrine4;

        [JsonProperty("aspectTrine5")]
        public string aspectTrine5;

        [JsonProperty("aspectTrine6")]
        public string aspectTrine6;

        [JsonProperty("aspectTrine7")]
        public string aspectTrine7;

        [JsonProperty("aspectSquare1")]
        public string aspectSquare1;

        [JsonProperty("aspectSquare2")]
        public string aspectSquare2;

        [JsonProperty("aspectSquare3")]
        public string aspectSquare3;

        [JsonProperty("aspectSquare4")]
        public string aspectSquare4;

        [JsonProperty("aspectSquare5")]
        public string aspectSquare5;

        [JsonProperty("aspectSquare6")]
        public string aspectSquare6;

        [JsonProperty("aspectSquare7")]
        public string aspectSquare7;

        [JsonProperty("aspectSextile1")]
        public string aspectSextile1;

        [JsonProperty("aspectSextile2")]
        public string aspectSextile2;

        [JsonProperty("aspectSextile3")]
        public string aspectSextile3;

        [JsonProperty("aspectSextile4")]
        public string aspectSextile4;

        [JsonProperty("aspectSextile5")]
        public string aspectSextile5;

        [JsonProperty("aspectSextile6")]
        public string aspectSextile6;

        [JsonProperty("aspectSextile7")]
        public string aspectSextile7;

        [JsonProperty("orb_sun_soft_1st")]
        public string orb_sun_soft_1st;

        [JsonProperty("orb_sun_hard_1st")]
        public string orb_sun_hard_1st;

        [JsonProperty("orb_sun_soft_2nd")]
        public string orb_sun_soft_2nd;

        [JsonProperty("orb_sun_hard_2nd")]
        public string orb_sun_hard_2nd;

        [JsonProperty("orb_sun_soft_150")]
        public string orb_sun_soft_150;

        [JsonProperty("orb_sun_hard_150")]
        public string orb_sun_hard_150;

        [JsonProperty("orb_moon_soft_1st")]
        public string orb_moon_soft_1st;

        [JsonProperty("orb_moon_hard_1st")]
        public string orb_moon_hard_1st;

        [JsonProperty("orb_moon_soft_2nd")]
        public string orb_moon_soft_2nd;

        [JsonProperty("orb_moon_hard_2nd")]
        public string orb_moon_hard_2nd;

        [JsonProperty("orb_moon_soft_150")]
        public string orb_moon_soft_150;

        [JsonProperty("orb_moon_hard_150")]
        public string orb_moon_hard_150;

        [JsonProperty("orb_other_soft_1st")]
        public string orb_other_soft_1st;

        [JsonProperty("orb_other_hard_1st")]
        public string orb_other_hard_1st;

        [JsonProperty("orb_other_soft_2nd")]
        public string orb_other_soft_2nd;

        [JsonProperty("orb_other_hard_2nd")]
        public string orb_other_hard_2nd;

        [JsonProperty("orb_other_soft_150")]
        public string orb_other_soft_150;

        [JsonProperty("orb_other_hard_150")]
        public string orb_other_hard_150;

        public string ConvertBools(bool[] bools)
        {
            string boolStr = "";
            foreach (var s in bools)
            {
                boolStr += s.ToString() + ",";
            }
            return boolStr.TrimEnd(',');
        }

        private string DispPlanetStr(SettingData data, int commonData)
        {
            return data.dispPlanet[0][commonData].ToString() + "," +
                data.dispPlanet[1][commonData].ToString() + "," +
                data.dispPlanet[2][commonData].ToString() + "," +
                data.dispPlanet[3][commonData].ToString() + "," +
                data.dispPlanet[4][commonData].ToString() + "," +
                data.dispPlanet[5][commonData].ToString() + "," +
                data.dispPlanet[6][commonData].ToString();
        }

        private string DispAspectPlanetStr(SettingData data, int commonData)
        {
            return data.dispAspectPlanet[0][commonData].ToString() + "," +
                data.dispAspectPlanet[1][commonData].ToString() + "," +
                data.dispAspectPlanet[2][commonData].ToString() + "," +
                data.dispAspectPlanet[3][commonData].ToString() + "," +
                data.dispAspectPlanet[4][commonData].ToString() + "," +
                data.dispAspectPlanet[5][commonData].ToString() + "," +
                data.dispAspectPlanet[6][commonData].ToString() + "," +
                data.dispAspectPlanet[7][commonData].ToString() + "," +
                data.dispAspectPlanet[8][commonData].ToString() + "," +
                data.dispAspectPlanet[9][commonData].ToString() + "," +
                data.dispAspectPlanet[10][commonData].ToString() + "," +
                data.dispAspectPlanet[11][commonData].ToString() + "," +
                data.dispAspectPlanet[12][commonData].ToString() + "," +
                data.dispAspectPlanet[13][commonData].ToString() + "," +
                data.dispAspectPlanet[14][commonData].ToString() + "," +
                data.dispAspectPlanet[15][commonData].ToString() + "," +
                data.dispAspectPlanet[16][commonData].ToString() + "," +
                data.dispAspectPlanet[17][commonData].ToString() + "," +
                data.dispAspectPlanet[18][commonData].ToString() + "," +
                data.dispAspectPlanet[19][commonData].ToString() + "," +
                data.dispAspectPlanet[20][commonData].ToString() + "," +
                data.dispAspectPlanet[21][commonData].ToString() + "," +
                data.dispAspectPlanet[22][commonData].ToString() + "," +
                data.dispAspectPlanet[23][commonData].ToString() + "," +
                data.dispAspectPlanet[24][commonData].ToString() + "," +
                data.dispAspectPlanet[25][commonData].ToString() + "," +
                data.dispAspectPlanet[26][commonData].ToString() + "," +
                data.dispAspectPlanet[27][commonData].ToString();
        }

        public SettingJson()
        {
            version = 1;
            dispname = "名称未設定";
            dispPlanetSun = "true,true,true,true,true,true,true";
            dispPlanetMoon = "true,true,true,true,true,true,true";
            dispPlanetMercury = "true,true,true,true,true,true,true";
            dispPlanetVenus = "true,true,true,true,true,true,true";
            dispPlanetMars = "true,true,true,true,true,true,true";
            dispPlanetJupiter = "true,true,true,true,true,true,true";
            dispPlanetSaturn = "true,true,true,true,true,true,true";
            dispPlanetUranus = "true,true,true,true,true,true,true";
            dispPlanetNeptune = "true,true,true,true,true,true,true";
            dispPlanetPluto = "true,true,true,true,true,true,true";
            dispPlanetDh = "true,true,true,true,true,true,true";
            dispPlanetAsc = "true,true,true,true,true,true,true";
            dispPlanetMc = "true,true,true,true,true,true,true";
            dispPlanetChiron = "true,true,true,true,true,true,true";
            dispPlanetEarth = "false,false,false,false,false,false,false";
            dispPlanetLilith = "false,false,false,false,false,false,false";
            dispPlanetCeres = "false,false,false,false,false,false,false";
            dispPlanetPallas = "false,false,false,false,false,false,false";
            dispPlanetJuno = "false,false,false,false,false,false,false";
            dispPlanetVesta = "false,false,false,false,false,false,false";
            dispPlanetEris = "false,false,false,false,false,false,false";
            dispPlanetSedna = "false,false,false,false,false,false,false";
            dispPlanetHaumea = "false,false,false,false,false,false,false";
            dispPlanetMakemake = "false,false,false,false,false,false,false";
            dispPlanetVt = "false,false,false,false,false,false,false";
            dispPlanetPof = "false,false,false,false,false,false,false";
            aspectSun = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectMoon = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectMercury = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectVenus = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectMars = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectJupiter = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectSaturn = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectUranus = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectNeptune = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectPluto = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectDh = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectAsc = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectMc = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true"; 
            aspectChiron = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectEarth = "true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true";
            aspectConjunction1 = "true,true,true,true,true,true,true";
            aspectConjunction2 = "true,true,true,true,true,true,true";
            aspectConjunction3 = "true,true,true,true,true,true,true";
            aspectConjunction4 = "true,true,true,true,true,true,true";
            aspectConjunction5 = "true,true,true,true,true,true,true";
            aspectConjunction6 = "true,true,true,true,true,true,true";
            aspectConjunction7 = "true,true,true,true,true,true,true";
            aspectOpposition1 = "true,true,true,true,true,true,true";
            aspectOpposition2 = "true,true,true,true,true,true,true";
            aspectOpposition3 = "true,true,true,true,true,true,true";
            aspectOpposition4 = "true,true,true,true,true,true,true";
            aspectOpposition5 = "true,true,true,true,true,true,true";
            aspectOpposition6 = "true,true,true,true,true,true,true";
            aspectOpposition7 = "true,true,true,true,true,true,true";
            aspectTrine1 = "true,true,true,true,true,true,true";
            aspectTrine2 = "true,true,true,true,true,true,true";
            aspectTrine3 = "true,true,true,true,true,true,true";
            aspectTrine4 = "true,true,true,true,true,true,true";
            aspectTrine5 = "true,true,true,true,true,true,true";
            aspectTrine6 = "true,true,true,true,true,true,true";
            aspectTrine7 = "true,true,true,true,true,true,true";
            aspectTrine7 = "true,true,true,true,true,true,true";
            aspectSquare1 = "true,true,true,true,true,true,true";
            aspectSquare2 = "true,true,true,true,true,true,true";
            aspectSquare3 = "true,true,true,true,true,true,true";
            aspectSquare4 = "true,true,true,true,true,true,true";
            aspectSquare5 = "true,true,true,true,true,true,true";
            aspectSquare6 = "true,true,true,true,true,true,true";
            aspectSquare7 = "true,true,true,true,true,true,true";
            aspectSextile1 = "true,true,true,true,true,true,true";
            aspectSextile2 = "true,true,true,true,true,true,true";
            aspectSextile3 = "true,true,true,true,true,true,true";
            aspectSextile4 = "true,true,true,true,true,true,true";
            aspectSextile5 = "true,true,true,true,true,true,true";
            aspectSextile6 = "true,true,true,true,true,true,true";
            aspectSextile7 = "true,true,true,true,true,true,true";
            orb_sun_soft_1st = "8.0,8.0,8.0,8.0,8.0,8.0,8.0";
            orb_sun_hard_1st = "6.0,6.0,6.0,6.0,6.0,6.0,6.0";
            orb_sun_soft_2nd = "6.0,6.0,6.0,6.0,6.0,6.0,6.0";
            orb_sun_hard_2nd = "4.0,4.0,4.0,4.0,4.0,4.0,4.0";
            orb_sun_soft_150 = "3.0,3.0,3.0,3.0,3.0,3.0,3.0";
            orb_sun_hard_150 = "1.5,1.5,1.5,1.5,1.5,1.5,1.5";
            orb_moon_soft_1st = "8.0,8.0,8.0,8.0,8.0,8.0,8.0";
            orb_moon_hard_1st = "6.0,6.0,6.0,6.0,6.0,6.0,6.0";
            orb_moon_soft_2nd = "6.0,6.0,6.0,6.0,6.0,6.0,6.0";
            orb_moon_hard_2nd = "4.0,4.0,4.0,4.0,4.0,4.0,4.0";
            orb_moon_soft_150 = "3.0,3.0,3.0,3.0,3.0,3.0,3.0";
            orb_moon_hard_150 = "1.5,1.5,1.5,1.5,1.5,1.5,1.5";
            orb_other_soft_1st = "5.0,5.0,5.0,5.0,5.0,5.0,5.0";
            orb_other_hard_1st = "3.0,3.0,3.0,3.0,3.0,3.0,3.0";
            orb_other_soft_2nd = "4.0,4.0,4.0,4.0,4.0,4.0,4.0";
            orb_other_hard_2nd = "2.0,2.0,2.0,2.0,2.0,2.0,2.0";
            orb_other_soft_150 = "1.5,1.5,1.5,1.5,1.5,1.5,1.5";
            orb_other_hard_150 = "1.0,1.0,1.0,1.0,1.0,1.0,1.0";
        }

        public SettingJson(SettingData data)
        {
            version = data.version;
            dispname = data.dispName;
            dispPlanetSun = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_SUN);
            dispPlanetMoon = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_MOON);
            dispPlanetMercury = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_MERCURY);
            dispPlanetVenus = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_VENUS);
            dispPlanetMars = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_MARS);
            dispPlanetJupiter = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_JUPITER);
            dispPlanetSaturn = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_SATURN);
            dispPlanetUranus = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_URANUS);
            dispPlanetNeptune = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_NEPTUNE);
            dispPlanetPluto = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_PLUTO);
            dispPlanetDh = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_DH_TRUENODE);
            dispPlanetAsc = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_ASC);
            dispPlanetMc = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_MC);
            dispPlanetChiron = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_CHIRON);
            dispPlanetEarth = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_EARTH);
            dispPlanetLilith = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_LILITH);
            dispPlanetCeres = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_CERES);
            dispPlanetPallas = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_PALLAS);
            dispPlanetJuno = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_JUNO);
            dispPlanetVesta = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_VESTA);
            dispPlanetEris = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_ERIS);
            dispPlanetSedna = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_SEDNA);
            dispPlanetHaumea = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_HAUMEA);
            dispPlanetMakemake = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_MAKEMAKE);
            dispPlanetVt = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_VT);
            dispPlanetPof = DispPlanetStr(data, CommonData.ZODIAC_NUMBER_POF);

            aspectSun = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_SUN);
            aspectMoon = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_MOON);
            aspectMercury = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_MERCURY);
            aspectVenus = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_VENUS);
            aspectMars = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_MARS);
            aspectJupiter = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_JUPITER);
            aspectSaturn = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_SATURN);
            aspectUranus = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_URANUS);
            aspectNeptune = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_NEPTUNE);
            aspectPluto = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_PLUTO);
            aspectDh = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_DH_TRUENODE);
            aspectAsc = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_ASC);
            aspectMc = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_MC);
            aspectChiron = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_CHIRON);
            aspectEarth = DispAspectPlanetStr(data, CommonData.ZODIAC_NUMBER_EARTH);

            orb_sun_hard_1st = data.orbs[0][OrbKind.SUN_HARD_1ST].ToString() + ',' +
                data.orbs[1][OrbKind.SUN_HARD_1ST].ToString() + ',' +
                data.orbs[2][OrbKind.SUN_HARD_1ST].ToString() + ',' +
                data.orbs[3][OrbKind.SUN_HARD_1ST].ToString() + ',' +
                data.orbs[4][OrbKind.SUN_HARD_1ST].ToString() + ',' +
                data.orbs[5][OrbKind.SUN_HARD_1ST].ToString() + ',' +
                data.orbs[6][OrbKind.SUN_HARD_1ST].ToString();

            orb_sun_soft_1st = data.orbs[0][OrbKind.SUN_SOFT_1ST].ToString() + ',' +
                data.orbs[1][OrbKind.SUN_SOFT_1ST].ToString() + ',' +
                data.orbs[2][OrbKind.SUN_SOFT_1ST].ToString() + ',' +
                data.orbs[3][OrbKind.SUN_SOFT_1ST].ToString() + ',' +
                data.orbs[4][OrbKind.SUN_SOFT_1ST].ToString() + ',' +
                data.orbs[5][OrbKind.SUN_SOFT_1ST].ToString() + ',' +
                data.orbs[6][OrbKind.SUN_SOFT_1ST].ToString();

            orb_sun_hard_2nd = data.orbs[0][OrbKind.SUN_HARD_2ND].ToString() + ',' +
                data.orbs[1][OrbKind.SUN_HARD_2ND].ToString() + ',' +
                data.orbs[2][OrbKind.SUN_HARD_2ND].ToString() + ',' +
                data.orbs[3][OrbKind.SUN_HARD_2ND].ToString() + ',' +
                data.orbs[4][OrbKind.SUN_HARD_2ND].ToString() + ',' +
                data.orbs[5][OrbKind.SUN_HARD_2ND].ToString() + ',' +
                data.orbs[6][OrbKind.SUN_HARD_2ND].ToString();

            orb_sun_soft_2nd = data.orbs[0][OrbKind.SUN_SOFT_2ND].ToString() + ',' +
                data.orbs[1][OrbKind.SUN_SOFT_2ND].ToString() + ',' +
                data.orbs[2][OrbKind.SUN_SOFT_2ND].ToString() + ',' +
                data.orbs[3][OrbKind.SUN_SOFT_2ND].ToString() + ',' +
                data.orbs[4][OrbKind.SUN_SOFT_2ND].ToString() + ',' +
                data.orbs[5][OrbKind.SUN_SOFT_2ND].ToString() + ',' +
                data.orbs[6][OrbKind.SUN_SOFT_2ND].ToString();

            orb_sun_hard_150 = data.orbs[0][OrbKind.SUN_HARD_150].ToString() + ',' +
                data.orbs[1][OrbKind.SUN_HARD_150].ToString() + ',' +
                data.orbs[2][OrbKind.SUN_HARD_150].ToString() + ',' +
                data.orbs[3][OrbKind.SUN_HARD_150].ToString() + ',' +
                data.orbs[4][OrbKind.SUN_HARD_150].ToString() + ',' +
                data.orbs[5][OrbKind.SUN_HARD_150].ToString() + ',' +
                data.orbs[6][OrbKind.SUN_HARD_150].ToString();

            orb_sun_soft_150 = data.orbs[0][OrbKind.SUN_SOFT_150].ToString() + ',' +
                data.orbs[1][OrbKind.SUN_SOFT_150].ToString() + ',' +
                data.orbs[2][OrbKind.SUN_SOFT_150].ToString() + ',' +
                data.orbs[3][OrbKind.SUN_SOFT_150].ToString() + ',' +
                data.orbs[4][OrbKind.SUN_SOFT_150].ToString() + ',' +
                data.orbs[5][OrbKind.SUN_SOFT_150].ToString() + ',' +
                data.orbs[6][OrbKind.SUN_SOFT_150].ToString();

            orb_moon_hard_1st = data.orbs[0][OrbKind.MOON_HARD_1ST].ToString() + ',' +
                data.orbs[1][OrbKind.MOON_HARD_1ST].ToString() + ',' +
                data.orbs[2][OrbKind.MOON_HARD_1ST].ToString() + ',' +
                data.orbs[3][OrbKind.MOON_HARD_1ST].ToString() + ',' +
                data.orbs[4][OrbKind.MOON_HARD_1ST].ToString() + ',' +
                data.orbs[5][OrbKind.MOON_HARD_1ST].ToString() + ',' +
                data.orbs[6][OrbKind.MOON_HARD_1ST].ToString();

            orb_moon_soft_1st = data.orbs[0][OrbKind.MOON_SOFT_1ST].ToString() + ',' +
                data.orbs[1][OrbKind.MOON_SOFT_1ST].ToString() + ',' +
                data.orbs[2][OrbKind.MOON_SOFT_1ST].ToString() + ',' +
                data.orbs[3][OrbKind.MOON_SOFT_1ST].ToString() + ',' +
                data.orbs[4][OrbKind.MOON_SOFT_1ST].ToString() + ',' +
                data.orbs[5][OrbKind.MOON_SOFT_1ST].ToString() + ',' +
                data.orbs[6][OrbKind.MOON_SOFT_1ST].ToString();

            orb_moon_hard_2nd = data.orbs[0][OrbKind.MOON_HARD_2ND].ToString() + ',' +
                data.orbs[1][OrbKind.MOON_HARD_2ND].ToString() + ',' +
                data.orbs[2][OrbKind.MOON_HARD_2ND].ToString() + ',' +
                data.orbs[3][OrbKind.MOON_HARD_2ND].ToString() + ',' +
                data.orbs[4][OrbKind.MOON_HARD_2ND].ToString() + ',' +
                data.orbs[5][OrbKind.MOON_HARD_2ND].ToString() + ',' +
                data.orbs[6][OrbKind.MOON_HARD_2ND].ToString();

            orb_moon_soft_2nd = data.orbs[0][OrbKind.MOON_SOFT_2ND].ToString() + ',' +
                data.orbs[1][OrbKind.MOON_SOFT_2ND].ToString() + ',' +
                data.orbs[2][OrbKind.MOON_SOFT_2ND].ToString() + ',' +
                data.orbs[3][OrbKind.MOON_SOFT_2ND].ToString() + ',' +
                data.orbs[4][OrbKind.MOON_SOFT_2ND].ToString() + ',' +
                data.orbs[5][OrbKind.MOON_SOFT_2ND].ToString() + ',' +
                data.orbs[6][OrbKind.MOON_SOFT_2ND].ToString();

            orb_moon_hard_150 = data.orbs[0][OrbKind.MOON_HARD_150].ToString() + ',' +
                data.orbs[1][OrbKind.MOON_HARD_150].ToString() + ',' +
                data.orbs[2][OrbKind.MOON_HARD_150].ToString() + ',' +
                data.orbs[3][OrbKind.MOON_HARD_150].ToString() + ',' +
                data.orbs[4][OrbKind.MOON_HARD_150].ToString() + ',' +
                data.orbs[5][OrbKind.MOON_HARD_150].ToString() + ',' +
                data.orbs[6][OrbKind.MOON_HARD_150].ToString();

            orb_moon_soft_150 = data.orbs[0][OrbKind.MOON_SOFT_150].ToString() + ',' +
                data.orbs[1][OrbKind.MOON_SOFT_150].ToString() + ',' +
                data.orbs[2][OrbKind.MOON_SOFT_150].ToString() + ',' +
                data.orbs[3][OrbKind.MOON_SOFT_150].ToString() + ',' +
                data.orbs[4][OrbKind.MOON_SOFT_150].ToString() + ',' +
                data.orbs[5][OrbKind.MOON_SOFT_150].ToString() + ',' +
                data.orbs[6][OrbKind.MOON_SOFT_150].ToString();

            orb_other_hard_1st = data.orbs[0][OrbKind.OTHER_HARD_1ST].ToString() + ',' +
                data.orbs[1][OrbKind.OTHER_HARD_1ST].ToString() + ',' +
                data.orbs[2][OrbKind.OTHER_HARD_1ST].ToString() + ',' +
                data.orbs[3][OrbKind.OTHER_HARD_1ST].ToString() + ',' +
                data.orbs[4][OrbKind.OTHER_HARD_1ST].ToString() + ',' +
                data.orbs[5][OrbKind.OTHER_HARD_1ST].ToString() + ',' +
                data.orbs[6][OrbKind.OTHER_HARD_1ST].ToString();

            orb_other_soft_1st = data.orbs[0][OrbKind.OTHER_SOFT_1ST].ToString() + ',' +
                data.orbs[1][OrbKind.OTHER_SOFT_1ST].ToString() + ',' +
                data.orbs[2][OrbKind.OTHER_SOFT_1ST].ToString() + ',' +
                data.orbs[3][OrbKind.OTHER_SOFT_1ST].ToString() + ',' +
                data.orbs[4][OrbKind.OTHER_SOFT_1ST].ToString() + ',' +
                data.orbs[5][OrbKind.OTHER_SOFT_1ST].ToString() + ',' +
                data.orbs[6][OrbKind.OTHER_SOFT_1ST].ToString();

            orb_other_hard_2nd = data.orbs[0][OrbKind.OTHER_HARD_2ND].ToString() + ',' +
                data.orbs[1][OrbKind.OTHER_HARD_2ND].ToString() + ',' +
                data.orbs[2][OrbKind.OTHER_HARD_2ND].ToString() + ',' +
                data.orbs[3][OrbKind.OTHER_HARD_2ND].ToString() + ',' +
                data.orbs[4][OrbKind.OTHER_HARD_2ND].ToString() + ',' +
                data.orbs[5][OrbKind.OTHER_HARD_2ND].ToString() + ',' +
                data.orbs[6][OrbKind.OTHER_HARD_2ND].ToString();

            orb_other_soft_2nd = data.orbs[0][OrbKind.OTHER_SOFT_2ND].ToString() + ',' +
                data.orbs[1][OrbKind.OTHER_SOFT_2ND].ToString() + ',' +
                data.orbs[2][OrbKind.OTHER_SOFT_2ND].ToString() + ',' +
                data.orbs[3][OrbKind.OTHER_SOFT_2ND].ToString() + ',' +
                data.orbs[4][OrbKind.OTHER_SOFT_2ND].ToString() + ',' +
                data.orbs[5][OrbKind.OTHER_SOFT_2ND].ToString() + ',' +
                data.orbs[6][OrbKind.OTHER_SOFT_2ND].ToString();

            orb_other_hard_150 = data.orbs[0][OrbKind.OTHER_HARD_150].ToString() + ',' +
                data.orbs[1][OrbKind.OTHER_HARD_150].ToString() + ',' +
                data.orbs[2][OrbKind.OTHER_HARD_150].ToString() + ',' +
                data.orbs[3][OrbKind.OTHER_HARD_150].ToString() + ',' +
                data.orbs[4][OrbKind.OTHER_HARD_150].ToString() + ',' +
                data.orbs[5][OrbKind.OTHER_HARD_150].ToString() + ',' +
                data.orbs[6][OrbKind.OTHER_HARD_150].ToString();

            orb_other_soft_150 = data.orbs[0][OrbKind.OTHER_SOFT_150].ToString() + ',' +
                data.orbs[1][OrbKind.OTHER_SOFT_150].ToString() + ',' +
                data.orbs[2][OrbKind.OTHER_SOFT_150].ToString() + ',' +
                data.orbs[3][OrbKind.OTHER_SOFT_150].ToString() + ',' +
                data.orbs[4][OrbKind.OTHER_SOFT_150].ToString() + ',' +
                data.orbs[5][OrbKind.OTHER_SOFT_150].ToString() + ',' +
                data.orbs[6][OrbKind.OTHER_SOFT_150].ToString();

            aspectConjunction = "";
            for (int i = 0; i < 28; i++)
            {
                aspectConjunction += data.dispAspectCategory[i][Models.AspectKind.CONJUNCTION].ToString();
                if (i < 27)
                {
                    aspectConjunction += ',';
                }
            }

            aspectOpposition = "";
            for (int i = 0; i < 28; i++)
            {
                aspectOpposition += data.dispAspectCategory[i][Models.AspectKind.OPPOSITION].ToString();
                if (i < 27)
                {
                    aspectOpposition += ',';
                }
            }

            aspectTrine = "";
            for (int i = 0; i < 28; i++)
            {
                aspectTrine += data.dispAspectCategory[i][Models.AspectKind.TRINE].ToString();
                if (i < 27)
                {
                    aspectTrine += ',';
                }
            }

            aspectSquare = "";
            for (int i = 0; i < 28; i++)
            {
                aspectSquare += data.dispAspectCategory[i][Models.AspectKind.SQUARE].ToString();
                if (i < 27)
                {
                    aspectSquare += ',';
                }
            }

            aspectSextile = "";
            for (int i = 0; i < 28; i++)
            {
                aspectSextile += data.dispAspectCategory[i][Models.AspectKind.SEXTILE].ToString();
                if (i < 27)
                {
                    aspectSextile += ',';
                }
            }


            // todo
        }
    }
}
